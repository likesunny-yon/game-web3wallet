{"id":"node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/transport.js","dependencies":[{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/transport.js.map","includedInParent":true,"mtime":1637149977859},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/package.json","includedInParent":true,"mtime":1637150058124},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/package.json","includedInParent":true,"mtime":1637149977859},{"name":"@shapeshiftoss/hdwallet-core","loc":{"line":32,"column":34},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/transport.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-core/dist/index.js"},{"name":"@shapeshiftoss/hdwallet-keepkey","loc":{"line":33,"column":37},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/transport.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey/dist/index.js"},{"name":"./utils","loc":{"line":34,"column":24},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/transport.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@shapeshiftoss/hdwallet-keepkey-webusb/dist/utils.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TransportDelegate = void 0;\nconst core = __importStar(require(\"@shapeshiftoss/hdwallet-core\"));\nconst keepkey = __importStar(require(\"@shapeshiftoss/hdwallet-keepkey\"));\nconst utils_1 = require(\"./utils\");\nclass TransportDelegate {\n    constructor(usbDevice) {\n        if (usbDevice.vendorId !== utils_1.VENDOR_ID)\n            throw new core.WebUSBCouldNotPair(\"KeepKey\", \"bad vendor id\");\n        if (usbDevice.productId !== utils_1.WEBUSB_PRODUCT_ID)\n            throw new core.FirmwareUpdateRequired(\"KeepKey\", \"6.1.0\");\n        this.usbDevice = usbDevice;\n    }\n    static create(device) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (device.vendorId !== utils_1.VENDOR_ID)\n                return null;\n            return new TransportDelegate(device);\n        });\n    }\n    getDeviceID() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.usbDevice.serialNumber;\n        });\n    }\n    isOpened() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.usbDevice.opened;\n        });\n    }\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.usbDevice.open();\n            if (this.usbDevice.configuration === null)\n                yield this.usbDevice.selectConfiguration(1);\n            try {\n                yield this.usbDevice.claimInterface(0);\n            }\n            catch (e) {\n                console.error(\"Could not claim interface 0\", this.usbDevice, { e });\n                if (core.isIndexable(e) && e.code === 18)\n                    // \"The requested interface implements a protected class\"\n                    throw new core.FirmwareUpdateRequired(\"KeepKey\", \"6.1.0\");\n                if (core.isIndexable(e) && e.code === 19)\n                    // \"Unable to claim interface\"\n                    throw new core.ConflictingApp(\"KeepKey\");\n                throw e;\n            }\n        });\n    }\n    tryConnectDebugLink() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // We have to use \"guess & check\" here because the browser doesn't give us a\n            // way to inspect the descriptors :(\n            try {\n                yield this.usbDevice.claimInterface(1);\n                return true;\n            }\n            catch (e) {\n                return false;\n            }\n        });\n    }\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.usbDevice.opened)\n                return;\n            try {\n                // If the device is disconnected, this will fail and throw, which is fine.\n                yield this.usbDevice.close();\n            }\n            catch (e) {\n                console.log(\"Error closing connection with usbDevice\");\n            }\n        });\n    }\n    writeChunk(buf, debugLink) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.usbDevice.transferOut(debugLink ? 2 : 1, buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength));\n        });\n    }\n    readChunk(debugLink) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { status, data } = yield this.usbDevice.transferIn(debugLink ? 2 : 1, keepkey.SEGMENT_SIZE + 1);\n            if (status === \"stall\") {\n                yield this.usbDevice.clearHalt(\"out\", debugLink ? 2 : 1);\n            }\n            if (data === undefined)\n                throw new Error(\"bad read\");\n            return new Uint8Array(core.toArrayBuffer(data));\n        });\n    }\n}\nexports.TransportDelegate = TransportDelegate;\n"},"sourceMaps":{"js":{"version":3,"file":"transport.js","sourceRoot":"","sources":["../src/transport.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mEAAqD;AACrD,yEAA2D;AAE3D,mCAAsD;AAGtD,MAAa,iBAAiB;IAG5B,YAAY,SAAiB;QAC3B,IAAI,SAAS,CAAC,QAAQ,KAAK,iBAAS;YAAE,MAAM,IAAI,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;QACpG,IAAI,SAAS,CAAC,SAAS,KAAK,yBAAiB;YAAE,MAAM,IAAI,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;QACzG,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAED,MAAM,CAAO,MAAM,CAAC,MAAc;;YAChC,IAAI,MAAM,CAAC,QAAQ,KAAK,iBAAS;gBAAE,OAAO,IAAI,CAAC;YAC/C,OAAO,IAAI,iBAAiB,CAAC,MAAM,CAAC,CAAC;QACvC,CAAC;KAAA;IAEK,WAAW;;YACf,OAAO,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC;QACrC,CAAC;KAAA;IAEK,QAAQ;;YACZ,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;QAC/B,CAAC;KAAA;IAEK,OAAO;;YACX,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;YAC5B,IAAI,IAAI,CAAC,SAAS,CAAC,aAAa,KAAK,IAAI;gBAAE,MAAM,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;YAEvF,IAAI;gBACF,MAAM,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;aACxC;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,KAAK,CAAC,6BAA6B,EAAE,IAAI,CAAC,SAAS,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;gBACpE,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,EAAE;oBACtC,yDAAyD;oBACzD,MAAM,IAAI,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;gBAC5D,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,EAAE;oBACtC,8BAA8B;oBAC9B,MAAM,IAAI,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;gBAC3C,MAAM,CAAC,CAAC;aACT;QACH,CAAC;KAAA;IAEK,mBAAmB;;YACvB,4EAA4E;YAC5E,oCAAoC;YACpC,IAAI;gBACF,MAAM,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;gBACvC,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,KAAK,CAAC;aACd;QACH,CAAC;KAAA;IAEK,UAAU;;YACd,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM;gBAAE,OAAO;YACnC,IAAI;gBACF,0EAA0E;gBAC1E,MAAM,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;aAC9B;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,GAAG,CAAC,yCAAyC,CAAC,CAAC;aACxD;QACH,CAAC;KAAA;IAEK,UAAU,CAAC,GAAe,EAAE,SAAkB;;YAClD,MAAM,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;QACzH,CAAC;KAAA;IAEK,SAAS,CAAC,SAAkB;;YAChC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;YAEtG,IAAI,MAAM,KAAK,OAAO,EAAE;gBACtB,MAAM,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aAC1D;YAED,IAAI,IAAI,KAAK,SAAS;gBAAE,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;YACpD,OAAO,IAAI,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;QAClD,CAAC;KAAA;CACF;AA3ED,8CA2EC","sourcesContent":[null]}},"error":null,"hash":"ac03fdd8f1e6c409cff30c1d1920022b","cacheData":{"env":{}}}