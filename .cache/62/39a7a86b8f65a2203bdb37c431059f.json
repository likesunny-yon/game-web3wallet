{"id":"node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/index.js","dependencies":[{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/index.js.map","includedInParent":true,"mtime":1632832198983},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/package.json","includedInParent":true,"mtime":1637150058124},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/package.json","includedInParent":true,"mtime":1632832198983},{"name":"./messageFormatter","loc":{"line":13,"column":35},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/index.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/messageFormatter.js"},{"name":"./methods","loc":{"line":65,"column":21},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/index.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@gnosis.pm/safe-apps-sdk/dist/src/communication/methods.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst messageFormatter_1 = require(\"./messageFormatter\");\nclass PostMessageCommunicator {\n    constructor(allowedOrigins = null, debugMode = false) {\n        this.allowedOrigins = null;\n        this.callbacks = new Map();\n        this.debugMode = false;\n        this.isValidMessage = ({ origin, data, source }) => {\n            const emptyOrMalformed = !data;\n            const sentFromParentEl = source === window.parent;\n            const majorVersionNumber = typeof data.version !== 'undefined' && parseInt(data.version.split('.')[0]);\n            const allowedSDKVersion = majorVersionNumber >= 1;\n            let validOrigin = true;\n            if (Array.isArray(this.allowedOrigins)) {\n                validOrigin = this.allowedOrigins.find((regExp) => regExp.test(origin)) !== undefined;\n            }\n            return !emptyOrMalformed && sentFromParentEl && allowedSDKVersion && validOrigin;\n        };\n        this.logIncomingMessage = (msg) => {\n            console.info(`Safe Apps SDK v1: A message was received from origin ${msg.origin}. `, msg.data);\n        };\n        this.onParentMessage = (msg) => {\n            if (this.isValidMessage(msg)) {\n                this.debugMode && this.logIncomingMessage(msg);\n                this.handleIncomingMessage(msg.data);\n            }\n        };\n        this.handleIncomingMessage = (payload) => {\n            const { id } = payload;\n            const cb = this.callbacks.get(id);\n            if (cb) {\n                cb(payload);\n                this.callbacks.delete(id);\n            }\n        };\n        this.send = (method, params) => {\n            const request = messageFormatter_1.MessageFormatter.makeRequest(method, params);\n            if (typeof window === 'undefined') {\n                throw new Error(\"Window doesn't exist\");\n            }\n            window.parent.postMessage(request, '*');\n            return new Promise((resolve) => {\n                this.callbacks.set(request.id, (response) => {\n                    resolve(response);\n                });\n            });\n        };\n        this.allowedOrigins = allowedOrigins;\n        this.debugMode = debugMode;\n        window.addEventListener('message', this.onParentMessage);\n    }\n}\nexports.default = PostMessageCommunicator;\n__exportStar(require(\"./methods\"), exports);\n"},"sourceMaps":{"js":{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/communication/index.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"3717c3b3662ba3c5573d98baee00c5a0","cacheData":{"env":{}}}