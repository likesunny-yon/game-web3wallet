{"id":"node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","dependencies":[{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js.map","includedInParent":true,"mtime":1632832244075},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/package.json","includedInParent":true,"mtime":1637150058124},{"name":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/package.json","includedInParent":true,"mtime":1632832244075},{"name":"react","loc":{"line":26,"column":37},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/react/index.js"},{"name":"react-qr-reader","loc":{"line":27,"column":50},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/react-qr-reader/lib/index.js"},{"name":"@cvbb/bc-ur","loc":{"line":28,"column":24},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/bc-ur/dist/index.js"},{"name":"events","loc":{"line":29,"column":25},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/events/events.js"},{"name":"../components/Button","loc":{"line":30,"column":25},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/components/Button.js"},{"name":"../components/Progress","loc":{"line":31,"column":27},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/components/Progress.js"},{"name":"../components/ButtonGroup","loc":{"line":32,"column":30},"parent":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/hooks/useAnimatedQRCodeReader.js","resolved":"/home/ryann/Documents/Repos/ChainSafe/Gaming/game-web3mobile/node_modules/@cvbb/sdk/dist/components/ButtonGroup.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAnimatedQRCodeReader = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst react_qr_reader_1 = __importDefault(require(\"react-qr-reader\"));\nconst bc_ur_1 = require(\"@cvbb/bc-ur\");\nconst events_1 = require(\"events\");\nconst Button_1 = require(\"../components/Button\");\nconst Progress_1 = require(\"../components/Progress\");\nconst ButtonGroup_1 = require(\"../components/ButtonGroup\");\nconst useAnimatedQRCodeReader = () => {\n    const [urCodes, setURCodes] = react_1.useState([]);\n    const [error, setError] = react_1.useState('');\n    const ee = react_1.useMemo(() => new events_1.EventEmitter(), []);\n    const [title, setTitle] = react_1.useState(null);\n    const [description, setDescription] = react_1.useState(null);\n    const reset = () => {\n        setURCodes([]);\n        setError('');\n    };\n    const processQRCode = (qr) => {\n        try {\n            processJSON(qr);\n        }\n        catch (e1) {\n            try {\n                processUR(qr);\n            }\n            catch (e2) {\n                processText(qr);\n            }\n        }\n    };\n    const handleStop = () => {\n        ee.emit('read', {\n            type: 'none',\n            result: '',\n        });\n    };\n    const handleRetry = () => {\n        reset();\n    };\n    const processJSON = (data) => {\n        JSON.parse(data);\n        ee.emit('read', {\n            type: 'json',\n            result: data,\n        });\n    };\n    const processText = (data) => {\n        ee.emit('read', {\n            type: 'text',\n            result: data,\n        });\n    };\n    const processUR = (ur) => {\n        try {\n            const [index, total] = bc_ur_1.extractSingleWorkload(ur);\n            if (urCodes.length > 0) {\n                const currentTotal = urCodes[0].total;\n                if (total !== currentTotal) {\n                    setError('invalid animated qrcode: mismatching qrs, please retry');\n                }\n            }\n            if (!urCodes.find((item) => item.index === index)) {\n                const newCodes = [...urCodes, { index, total, data: ur }];\n                setURCodes(newCodes);\n                if (newCodes.length === total) {\n                    const result = bc_ur_1.decodeUR(newCodes.map((item) => item.data));\n                    ee.emit('read', {\n                        type: 'ur',\n                        result,\n                    });\n                }\n            }\n        }\n        catch (e) {\n            setError(e.message);\n        }\n    };\n    const element = (react_1.default.createElement(\"div\", { style: {\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n        } },\n        title && react_1.default.createElement(\"p\", null, title),\n        description && react_1.default.createElement(\"p\", null, description),\n        react_1.default.createElement(react_qr_reader_1.default, { onScan: (data) => {\n                if (data) {\n                    processQRCode(data);\n                }\n            }, delay: 100, style: { width: '100%' }, onError: (e) => {\n                setError(e.message);\n            } }),\n        react_1.default.createElement(\"p\", null, urCodes[0] && urCodes[0].total > 1 && react_1.default.createElement(Progress_1.Progress, { progress: urCodes.length, total: urCodes[0].total })),\n        react_1.default.createElement(ButtonGroup_1.ButtonGroup, null,\n            react_1.default.createElement(Button_1.Button, { onClick: handleStop }, \"Close\"),\n            error && react_1.default.createElement(Button_1.Button, { onClick: handleRetry }, \"Retry\")),\n        error && react_1.default.createElement(\"p\", { style: { color: 'red' } }, error)));\n    return [\n        element,\n        {\n            read: (options) => {\n                return new Promise((resolve) => {\n                    console.log(options);\n                    if (options) {\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                    }\n                    ee.once('read', (result) => {\n                        reset();\n                        resolve(result);\n                    });\n                });\n            },\n        },\n    ];\n};\nexports.useAnimatedQRCodeReader = useAnimatedQRCodeReader;\n"},"sourceMaps":{"js":{"version":3,"file":"useAnimatedQRCodeReader.js","sourceRoot":"","sources":["../../lib/hooks/useAnimatedQRCodeReader.tsx"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"54f6ebe662cf95d3582d3d490f415174","cacheData":{"env":{}}}